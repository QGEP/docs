<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.3. Échange de données INTERLIS &mdash; Documentation QGEP 0.8</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=286ea6f5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/translations.js?v=041d0952"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="4.4. Personnalisation du modèle de données" href="../db-customization/index.html" />
    <link rel="prev" title="4.2. User Roles" href="../security/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QGEP
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../features-guide/index.html">1. TEKSI wastewater module (QGEP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation-guide/index.html">2. Guide d’installation de QGEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide/index.html">3. Guide d’utilisateur de QGEP</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">4. Guide d’administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../pgadmin/index.html">4.1. pgAdmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/index.html">4.2. User Roles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.3. Échange de données INTERLIS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">4.3.1. Général</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">4.3.2. Prérequis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#java">4.3.2.1. Java</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-libraries">4.3.2.2. Bibliothèques Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelbaker">4.3.2.3. Modelbaker</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qgep-version">4.3.2.4. Version QGEP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#usage-gui">4.3.3. Utilisation (GUI)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enable-admin-mode">4.3.3.1. Activer le mode admin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#export">4.3.3.2. Export</a></li>
<li class="toctree-l4"><a class="reference internal" href="#import">4.3.3.3. Import</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#usage-command-line">4.3.4. Utilisation (ligne de commande)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#further-quality-control">4.3.5. Further Quality Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quality-control-of-an-export-file-with-vsa-online-checker-fachprufung-mit-vsa-checker-online">4.3.5.1. Quality control of an export file with VSA online checker (Fachprüfung mit VSA Checker (online))</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../db-customization/index.html">4.4. Personnalisation du modèle de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datamodel-tool/index.html">4.5. Data-model tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../db-update-pum/index.html">4.6. Manual update of the datamodel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">5. Machine virtuelle de démonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wincan2qgep/index.html">6. Plugin Wincan 2 QGEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../qgep_swmm/index.html">7. SWMM Data Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation/index.html">8. Traduction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QGEP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">4. </span>Guide d’administration</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.3. </span>Échange de données INTERLIS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/admin-guide/interlis-io/index.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="interlis-data-exchange">
<h1><span class="section-number">4.3. </span>Échange de données INTERLIS<a class="headerlink" href="#interlis-data-exchange" title="Lien vers cette rubrique"></a></h1>
<p>Il s’agit d’un guide sur la façon d’importer/exporter des données entre QGEP et INTERLIS 2 Transfer Format (xtf).</p>
<section id="general">
<h2><span class="section-number">4.3.1. </span>Général<a class="headerlink" href="#general" title="Lien vers cette rubrique"></a></h2>
<p>The QGEP plugin includes an INTERLIS import/export feature.
It is currently capable of importing and exporting to the following models:</p>
<blockquote>
<div><ul class="simple">
<li><p>VSA-DSS “DSS_2015_LV95”</p></li>
<li><p>SIA405 Abwasser “SIA405_ABWASSER_2015_LV95`</p></li>
<li><p>VSA-KEK “VSA_KEK_2019_LV95”, which is an extension to the SIA405 wastewater model <cite>SIA405_ABWASSER_2015_LV95</cite> (for more details see <a class="reference external" href="https://github.com/QGEP/qgepqwat2ili/blob/master/qgepqwat2ili/config.py">config</a>).</p></li>
</ul>
</div></blockquote>
<p>Note that currently, exports are possible in German only. Translated exports are on the roadmap, let us know if you are interested in this feature.
In <a class="reference external" href="https://www.sjib.ch/wie-uebersetze-ich-eine-interlis-transferdatei-in-eine-andere-sprache/">this blog post</a> the manual translation with the tool ili2db is explained in detail.</p>
</section>
<section id="prerequisites">
<h2><span class="section-number">4.3.2. </span>Prérequis<a class="headerlink" href="#prerequisites" title="Lien vers cette rubrique"></a></h2>
<section id="java">
<h3><span class="section-number">4.3.2.1. </span>Java<a class="headerlink" href="#java" title="Lien vers cette rubrique"></a></h3>
<p>Vous avez besoin de Java sur votre système.</p>
<p>Windows : <a class="reference external" href="https://javadl.oracle.com/webapps/download/AutoDL?BundleId=245058_d3c52aa6bfa54d3ca74e617f18309292">Java for windows download</a>
MacOS : <a class="reference external" href="https://javadl.oracle.com/webapps/download/AutoDL?BundleId=245051_d3c52aa6bfa54d3ca74e617f18309292">Java for MacOS download</a>
Linux : use the package manager</p>
</section>
<section id="python-libraries">
<h3><span class="section-number">4.3.2.2. </span>Bibliothèques Python<a class="headerlink" href="#python-libraries" title="Lien vers cette rubrique"></a></h3>
<p>Vous avez besoin de <cite>sqlalchemy</cite> et <cite>geoalchemy2</cite>.</p>
<p>To install : before launching QGIS, open OSGeo4W Shell</p>
<figure class="align-default">
<img alt="../../_images/osgeo4wshell.jpg" src="../../_images/osgeo4wshell.jpg" />
</figure>
<p>and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pip3</span> <span class="n">install</span> <span class="s2">&quot;sqlalchemy~=1.3.22&quot;</span> <span class="s2">&quot;geoalchemy2&gt;=0.9.0&quot;</span>
</pre></div>
</div>
<p>If the command fails, try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pip3</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If pip cannot be found, make sure you’ve installed the python3-pip package using the OSGeo4W network installer (if you’ve installed the standalone version of QGIS, it should be included).</p>
</div>
<p>If this command still fails, try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pip3</span> <span class="n">install</span> <span class="o">--</span><span class="n">target</span><span class="o">=</span><span class="n">c</span><span class="p">:</span>\<span class="n">somewhere</span>\<span class="n">other</span>\<span class="n">than</span>\<span class="n">the</span>\<span class="n">default</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">c:\somewhere\other\than\the\default</span></code> is the path to your current pip package</p>
<p>The same <cite>–target</cite> flag can be added to install <cite>sqlalchemy</cite> and <cite>geoalchemy2</cite> in another location.</p>
</section>
<section id="modelbaker">
<h3><span class="section-number">4.3.2.3. </span>Modelbaker<a class="headerlink" href="#modelbaker" title="Lien vers cette rubrique"></a></h3>
<p>The QGEP plugin will propose to install the Modelbaker plugin automatically. If that did not work, install the QGIS plugin <cite>Modelbaker</cite> manually from the QGIS plugin manager (version 6.4 or newer but older than 7.1).</p>
</section>
<section id="qgep-version">
<h3><span class="section-number">4.3.2.4. </span>Version QGEP<a class="headerlink" href="#qgep-version" title="Lien vers cette rubrique"></a></h3>
<p>The export only supports up-to-date QGEP datamodel (1.6.1 at the time of writing). Ensure your datamodel is fully updated before trying to import/export.</p>
</section>
</section>
<section id="usage-gui">
<h2><span class="section-number">4.3.3. </span>Utilisation (GUI)<a class="headerlink" href="#usage-gui" title="Lien vers cette rubrique"></a></h2>
<section id="enable-admin-mode">
<h3><span class="section-number">4.3.3.1. </span>Activer le mode admin<a class="headerlink" href="#enable-admin-mode" title="Lien vers cette rubrique"></a></h3>
<p>Dans la boîte de dialogue <cite>plugin&gt;QGEP&gt;settings</cite>, sous l’onglet <cite>Developer options</cite>, assurez-vous que le <cite>Admin mode</cite> est activé. Redémarrez QGIS.</p>
<figure class="align-default">
<img alt="../../_images/settings_dialog.png" src="../../_images/settings_dialog.png" />
</figure>
<p>Vous devriez maintenant voir les nouveaux boutons <cite>import</cite> et <cite>export</cite> dans la barre d’outils QGEP.</p>
<figure class="align-default">
<img alt="../../_images/toolbar.png" src="../../_images/toolbar.png" />
</figure>
</section>
<section id="export">
<h3><span class="section-number">4.3.3.2. </span>Export<a class="headerlink" href="#export" title="Lien vers cette rubrique"></a></h3>
<p>Pour exporter vos données QGEP, cliquez sur le bouton <cite>export</cite>. Le dialogue suivant apparaîtra.</p>
<figure class="align-default">
<img alt="../../_images/export_dialog_new.png" src="../../_images/export_dialog_new.png" />
</figure>
<p>Choose the model you want to export into.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you select VSA_KEK_2019_LV95 then two xtf files are created - SIA405_ABWASSER_2015_LV95 (the network data) and VSA_KEK_2019_LV95 (network and sewer TV data).</p>
</div>
<p>If you have an active selection in the nodes and/or reaches layer, you can choose to restrict the export to that selection. This is especially useful in combination with the upstream/downstream selection tools.</p>
<figure class="align-default">
<img alt="../../_images/selection.png" src="../../_images/selection.png" />
</figure>
<figure class="align-default">
<img alt="../../_images/selection_export.png" src="../../_images/selection_export.png" />
</figure>
<p>The export tool is capable of exporting label positions for different scales. You can choose which scales you are interested in exporting by selected/deselecting them.</p>
<p>You can also change the angle for horizontal text in INTERLIS if your target system has another convention than INTERLIS.</p>
<p>Ensuite, confirmez le dialogue et choisissez où enregistrer le fichier <cite>.xtf</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The export model name will be added to your filename that you choose. export.xtf will become export_DSS_2015_LV95.xtf</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that windows file pathes with empty strings in the directory path or filename are not supported at the moment.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notez que pour des exportations importantes/complets, l’exécution peut prendre beaucoup de temps.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that QGIS standard behaviour for too long labels is to turn them horizontally (orientation = 0). You can adjust the properties of the vw_qgep_reach layer - Symbology - Placement - Label overrun from « no overrun » to e.g. 7 mm (Millimeter)</p>
</div>
<figure class="align-default">
<img alt="../../_images/layer_vw_qgep_reach_label_overrun.png" src="../../_images/layer_vw_qgep_reach_label_overrun.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that remark fields are truncated to 80 characters on INTERLIS Export, as the INTERLIS definition is like this. If you have remark fields with more text then consider to move this data to documentation with the classes « file » and « data_media » so it can be exported to INTERLIS completely where you can add any document, photo or video to a class.</p>
</div>
<p>INTERLIS export starts with two integrity checks:</p>
<p>1. Integrity check Organisation subclasses
For VSA-DSS 2015 Export each organisation needs to be related to one of the seven subclasses of organisation (administrative_office, canton, cooperative, municipality, privat, wastewater_association, wastewater_treatment_plant).</p>
<figure class="align-default">
<img alt="../../_images/interlis_export_integrity_checks_organisations_subclasses.png" src="../../_images/interlis_export_integrity_checks_organisations_subclasses.png" />
</figure>
<p>If you get this error add a superclass reference by adding the value of the respective organisation in the corresponding organisation subclass.</p>
<figure class="align-default">
<img alt="../../_images/add_organisation_subclass_reference.png" src="../../_images/add_organisation_subclass_reference.png" />
</figure>
<p>2. Integrity check identifiers
All export models define the identifier attribute as MANDATORY. Therefore the export tool first checks if there are identfiers that are NULL</p>
<figure class="align-default">
<img alt="../../_images/interlis_export_integrity_checks_identifiers.png" src="../../_images/interlis_export_integrity_checks_identifiers.png" />
</figure>
<p>You will get a list of missing identifiers per class. Please add an identifier. If you do not have a separte identifier scheme for that class just copy the obj_id.</p>
<p>Exports include a validation step using <cite>ilivalidator</cite>, which will inform you whether the export contains INTERLIS validation error.</p>
</section>
<section id="import">
<h3><span class="section-number">4.3.3.3. </span>Import<a class="headerlink" href="#import" title="Lien vers cette rubrique"></a></h3>
<p>To import <cite>xtf`files, click on the `import</cite> button and navigate to the <cite>.xtf</cite> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that windows file pathes with empty strings in the directory path or filename are not supported at the moment.</p>
</div>
<p>Click on <cite>open</cite> to select the import file.</p>
<p>The file will then be checked whether it contains data in one of the supported models.
Then a validation check with ilivalidator will take place in the background.</p>
<p>If the file is valid, then the import process will continue and the following dialog will appear.</p>
<figure class="align-default">
<img alt="../../_images/import_dialog.png" src="../../_images/import_dialog.png" />
</figure>
<p>La partie gauche de ce dialogue liste tous les éléments qui vont être importés du fichier <cite>.xtf</cite>, permettant de revoir ce qui va être importé et de désélectionner les éléments que vous souhaitez ignorer. Elle montre également le statut de validation de chaque objet, indiquant si une action supplémentaire est nécessaire (INVALID) ou recommandée (WARNING) avant l’importation.</p>
<p>La partie droite de ce dialogue présente un formulaire spécifique au type d’élément sélectionné dans la liste, permettant d’adapter l’importation. Par exemple, il permet d’attacher des « examens » à leurs canalisations.</p>
<p>Une fois que vous êtes satisfait des options d’importation, confirmez la boîte de dialogue afin de conserver les changements dans votre base de données.</p>
<p>Wait until you see the confirmation for a valid import.</p>
</section>
</section>
<section id="usage-command-line">
<h2><span class="section-number">4.3.4. </span>Utilisation (ligne de commande)<a class="headerlink" href="#usage-command-line" title="Lien vers cette rubrique"></a></h2>
<p>Pour une utilisation avancée, l’outil d’importation/exportation peut également être utilisé comme un outil de ligne de commande. Veuillez consulter le site <a class="reference external" href="https://github.com/QGEP/qgepqwat2ili/">https://github.com/QGEP/qgepqwat2ili/</a> pour obtenir de la documentation à ce sujet.</p>
</section>
<section id="further-quality-control">
<h2><span class="section-number">4.3.5. </span>Further Quality Control<a class="headerlink" href="#further-quality-control" title="Lien vers cette rubrique"></a></h2>
<section id="quality-control-of-an-export-file-with-vsa-online-checker-fachprufung-mit-vsa-checker-online">
<h3><span class="section-number">4.3.5.1. </span>Quality control of an export file with VSA online checker (Fachprüfung mit VSA Checker (online))<a class="headerlink" href="#quality-control-of-an-export-file-with-vsa-online-checker-fachprufung-mit-vsa-checker-online" title="Lien vers cette rubrique"></a></h3>
<figure class="align-default">
<img alt="https://vsa.ch/wp-content/uploads/2020/04/Daten-checker-d-f-it.jpg" src="https://vsa.ch/wp-content/uploads/2020/04/Daten-checker-d-f-it.jpg" />
</figure>
<p><a class="reference external" href="https://vsa.ch/fachbereiche-cc/siedlungsentwaesserung/generelle-entwaesserungsplanung/datenmanagement/#GEP-Datachecker">For details see explanation on the VSA Homepage</a></p>
<p><a class="reference external" href="https://vsa.ch/Mediathek/gep-datachecker-jahresgebuehr/?media_filter_two=lizenzen-software">Information about access and licensing you can get here</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="../security/index.html" class="btn btn-neutral float-left" title="4.2. User Roles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="../db-customization/index.html" class="btn btn-neutral float-right" title="4.4. Personnalisation du modèle de données" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2023, The QGEP Project www.teksi.ch.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>